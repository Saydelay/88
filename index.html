<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAYDELAY</title>
    <style>
        :root {
            --bg: #05020a;
            --card: rgba(255, 255, 255, 0.05);
            --purple: #b56bff;
            --purple-glow: rgba(181, 107, 255, 0.4);
            --text: #ffffff;
        }
        body {
            background: var(--bg);
            color: var(--text);
            font-family: 'Inter', -apple-system, sans-serif;
            margin: 0; padding: 0;
            background-image: radial-gradient(circle at 50% -20%, #2a104a 0%, var(--bg) 70%);
            min-height: 100vh;
        }

        /* Header & Suche */
        .container { max-width: 1200px; margin: 0 auto; padding: 40px 20px; }
        header { text-align: left; margin-bottom: 40px; display: flex; justify-content: space-between; align-items: center; }
        header h1 { font-size: 38px; margin: 0; background: linear-gradient(to right, #fff, var(--purple)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 800; }
        
        #search {
            width: 100%; max-width: 400px; padding: 14px 20px;
            background: rgba(255, 255, 255, 0.07); border: 1px solid rgba(255,255,255,0.1);
            border-radius: 14px; color: white; font-size: 16px; backdrop-filter: blur(10px);
            transition: 0.3s;
        }
        #search:focus { border-color: var(--purple); outline: none; box-shadow: 0 0 20px var(--purple-glow); }

        /* Grid System */
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 25px; }

        .card {
            background: var(--card); border-radius: 20px;
            overflow: hidden; cursor: pointer; border: 1px solid rgba(255,255,255,0.05);
            transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
            position: relative; backdrop-filter: blur(5px);
        }
        .card:hover { transform: translateY(-10px); border-color: var(--purple); box-shadow: 0 15px 30px rgba(0,0,0,0.5); }
        .card img { width: 100%; height: 260px; object-fit: cover; transition: 0.5s; }
        .card:hover img { transform: scale(1.1); }
        
        .card-content { padding: 15px; background: linear-gradient(to top, rgba(0,0,0,0.9), transparent); position: absolute; bottom: 0; width: 100%; box-sizing: border-box; }
        .card-title { font-weight: 700; font-size: 15px; margin: 0; }
        .card-type { font-size: 11px; text-transform: uppercase; color: var(--purple); letter-spacing: 1px; margin-bottom: 5px; display: block; }

        /* Detail-Ansicht (Serie) */
        #detail-view {
            position: fixed; inset: 0; background: rgba(5, 2, 10, 0.98);
            display: none; z-index: 2000; padding: 40px 20px; overflow-y: auto;
            backdrop-filter: blur(20px);
        }
        .detail-container { max-width: 800px; margin: 0 auto; }
        .detail-hero { display: flex; gap: 30px; margin-bottom: 40px; align-items: flex-end; }
        .detail-hero img { width: 180px; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.8); }
        
        .episode-list { display: flex; flex-direction: column; gap: 12px; }
        .episode-item {
            background: rgba(255,255,255,0.03); padding: 18px; border-radius: 15px;
            display: flex; justify-content: space-between; align-items: center;
            border: 1px solid rgba(255,255,255,0.05); cursor: pointer; transition: 0.3s;
        }
        .episode-item:hover { background: rgba(181, 107, 255, 0.1); border-color: var(--purple); }
        .watched-badge { color: #2ecc71; font-weight: bold; display: none; font-size: 14px; }
        .episode-item.watched .watched-badge { display: block; }

        .btn-close { background: none; border: 1px solid var(--purple); color: var(--purple); padding: 10px 20px; border-radius: 10px; cursor: pointer; margin-bottom: 20px; transition: 0.3s; }
        .btn-close:hover { background: var(--purple); color: white; }
    </style>
</head>
<body>

<div class="container" id="main-view">
    <header>
        <h1>SAYDELAY</h1>
        <input type="text" id="search" placeholder="Suche Filme oder Serien..." oninput="render()">
    </header>
    <div class="grid" id="content-grid"></div>
</div>

<div id="detail-view">
    <div class="detail-container">
        <button class="btn-close" onclick="closeDetail()">◀ ZURÜCK</button>
        <div class="detail-hero" id="detail-hero"></div>
        <div class="episode-list" id="episode-list"></div>
    </div>
</div>

<script>
    const database = [
        {
            id: "Fack ju Göhte",
            name: "Fack ju Göhte",
            type: "movie",
            cover: "Fack ju Göhte.jpg",
            link: "https://c.web.de/@1597605810140086734/lPNKObYFmrFNvZOOk3Z5gQ/ROOT/ROOT"
        },
        {
            id: "Fack ju Göhte 2",
            name: "Fack ju Göhte 2",
            type: "movie",
            cover: "Fack ju Göhte 2.jpg",
            link: "https://c.web.de/@1597631862077921322/0W_hLMCE4LVV6zctMXU4vw/ROOT/ROOT"
        },
        {
            id: "Fack ju Göhte 3",
            name: "Fack ju Göhte 3",
            type: "movie",
            cover: "Fack ju Göhte 3.jpg",
            link: "https://c.web.de/@1597631862077921322/-tUYVG2GZr0XfDECHlJKeg/ROOT/ROOT"
        },
        {
            id: "Anaconda",
            name: "Anaconda",
            type: "movie",
            cover: "anaconda.jpg",
            link: "https://c.web.de/@1598385663676252517/4KeRnonh5IQNDGcx22prtw/ROOT/ROOT"
        },
        {
            id: "Der Tiger",
            name: "Der Tiger",
            type: "movie",
            cover: "Der Tiger.jpg",
            link: "https://c.web.de/@1598385663676252517/-ocguydueQTSGH45P8cCNg/ROOT/ROOT"
        },
        {
            id: "Monster High Verspukt",
            name: "Monster High Verspukt",
            type: "movie",
            cover: "Monster High Verspukt.jpg",
            link: "https://c.web.de/@1598385663676252517/OlOHCaL9tndAvC8-wZqWhQ/ROOT/ROOT"
        },
        {
            id: "Zoomania",
            name: "Zoomania",
            type: "movie",
            cover: "Zoomania.jpg",
            link: "https://c.web.de/@1598259267113058525/9mFSuiVTO2Ci-gqTjp0ttg/ROOT/ROOT"
        },
        {
            id: "Dexter Staffel 6",
            name: "Dexter",
            type: "series",
            season: 6,
            cover: "Dexter Staffel 6 Episode 1.jpg",
            episodes: [
                { id: "D_s6_e1", title: "Folge 1", link: "https://c.web.de/@1597605810140086734/gVi0kvA9sfofl-vf-xtiIA/ROOT/ROOT" },
                { id: "D_s6_e2", title: "Folge 2", link: "https://c.web.de/@1597605810140086734/YD4WNAwMxjMRZwkaYfd1Yw/ROOT/ROOT" },
                { id: "D_s6_e3", title: "Folge 3", link: "https://c.web.de/@1597631862077921322/8ENGrpjnCrnbZdqSKo2OXA/ROOT/ROOT" },
                { id: "D_s6_e4", title: "Folge 4", link: "https://c.web.de/@1597631862077921322/K81cfNuEYjvSqdgX31izbg/ROOT/ROOT" },
                { id: "D_s6_e5", title: "Folge 5", link: "https://c.web.de/@1597631862077921322/FeckOwQkrFn0OVNYnm1M5w/ROOT/ROOT" },
                { id: "D_s6_e6", title: "Folge 6", link: "https://c.web.de/@1598253948035137885/ZYhS8cv8SstEGwFIRqxjog/ROOT/ROOT" },
                { id: "D_s6_e7", title: "GIBTS NICHT", link: "" },
                { id: "D_s6_e8", title: "Folge 8", link: "https://c.web.de/@1598253948035137885/iHcx-gkVAIK1sc_Iol8dWw/ROOT/ROOT" },
                { id: "D_s6_e9", title: "Folge 9", link: "https://c.web.de/@1598253948035137885/27guer4TjVYNt4_xD1yfRg/ROOT/ROOT" },
                { id: "D_s6_e10", title: "Folge 10", link: "https://c.web.de/@1598253948035137885/NF-CwR442PeGL35tq--Mag/ROOT/ROOT" },
                { id: "D_s6_e11", title: "Folge 11", link: "https://c.web.de/@1598253948035137885/v8PRLFxM3pi24HOZZW_4wg/ROOT/ROOT" },
                { id: "D_s6_e12", title: "Folge 12", link: "https://c.web.de/@1598259267113058525/uxmpmMiURwC6wwUzJtbIAA/ROOT/ROOT" },
            ]
        },
        {
            id: "Dexter Staffel 7",
            name: "Dexter",
            type: "series",
            season: 7,
            cover: "Dexter Staffel 7 Episode 1.jpg",
            episodes: [
                { id: "D_s7_e1", title: "Folge 1", link: "https://c.web.de/@1598259267113058525/WJGNVCoDXYHasVckDLyPEg/ROOT/ROOT" },
                { id: "D_s7_e2", title: "Folge 2", link: "https://c.web.de/@1598259267113058525/AS8BMuZZ4E_GUAn3d-fRLg/ROOT/ROOT" },
                { id: "D_s7_e3", title: "Folge 3", link: "https://c.web.de/@1598259267113058525/GxIS-wvo1zLr69QsBEt4Jg/ROOT/ROOT" },
                { id: "D_s7_e4", title: "Folge 4", link: "https://c.web.de/@1598259267113058525/3DonXVJf8yZj9GBOQGfgnw/ROOT/ROOT" },
                { id: "D_s7_e5", title: "Folge 5", link: "" },
                { id: "D_s7_e6", title: "Folge 6", link: "" },
                { id: "D_s7_e7", title: "Folge 7", link: "" },
                { id: "D_s7_e8", title: "Folge 8", link: "" },
                { id: "D_s7_e9", title: "Folge 9", link: "" },
                { id: "D_s7_e10", title: "Folge 10", link: "" },
                { id: "D_s7_e11", title: "Folge 11", link: "" },
                { id: "D_s7_e12", title: "Folge 12", link: "" },
            ]
        },
    ];

    let watchedList = JSON.parse(localStorage.getItem('watched_items')) || [];

    function render() {
        const query = document.getElementById('search').value.toLowerCase();
        const grid = document.getElementById('content-grid');
        grid.innerHTML = '';

        database.filter(i => i.name.toLowerCase().includes(query)).forEach((item, index) => {
            const card = document.createElement('div');
            card.className = 'card';
            card.innerHTML = `
                <img src="files/covers/${item.cover}" onerror="this.src='https://via.placeholder.com/200x300/1a1033/ffffff?text=${item.name}'">
                <div class="card-content">
                    <span class="card-type">${item.type === 'movie' ? 'Film' : 'Staffel ' + (item.season || 1)}</span>
                    <p class="card-title">${item.name}</p>
                </div>
            `;
            card.onclick = () => item.type === 'movie' ? play(item.link, item.id) : openDetail(index);
            grid.appendChild(card);
        });
    }

    function openDetail(index) {
        const item = database[index];
        const detailView = document.getElementById('detail-view');
        const hero = document.getElementById('detail-hero');
        const list = document.getElementById('episode-list');

        // HIER wird die Staffelnummer jetzt dynamisch eingesetzt
        hero.innerHTML = `
            <img src="files/covers/${item.cover}">
            <div>
                <h1 style="margin:0">${item.name}</h1>
                <p style="color:var(--purple)">Serie | Staffel ${item.season || 1}</p>
            </div>
        `;

        list.innerHTML = '';
        item.episodes.forEach(ep => {
            const isWatched = watchedList.includes(ep.id);
            const epDiv = document.createElement('div');
            epDiv.className = `episode-item ${isWatched ? 'watched' : ''}`;
            epDiv.innerHTML = `
                <span>${ep.title}</span>
                <span class="watched-badge">✔ GESEHEN</span>
            `;
            epDiv.onclick = () => play(ep.link, ep.id);
            list.appendChild(epDiv);
        });

        detailView.style.display = 'block';
        document.body.style.overflow = 'hidden';
    }

    function play(link, id) {
        if (!watchedList.includes(id)) {
            watchedList.push(id);
            localStorage.setItem('watched_items', JSON.stringify(watchedList));
        }
        window.open(link, '_blank');
        render(); 
    }

    function closeDetail() {
        document.getElementById('detail-view').style.display = 'none';
        document.body.style.overflow = 'auto';
        render();
    }

    window.onload = render;
</script>
